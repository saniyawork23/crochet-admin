<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crochet Admin ‚Äì Customers</title>

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    /* ================= NAVBAR ================= */
    .navbar {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 30px;
      background: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
      font-family: 'Poppins', sans-serif;
    }

    .nav-left {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .brand-icon { font-size: 22px; }

    .brand-name {
      font-size: 18px;
      font-weight: 600;
      color: #4f46e5;
    }

    .nav-links a {
      margin-left: 20px;
      text-decoration: none;
      font-size: 14px;
      color: #444;
      font-weight: 500;
    }

    .nav-links a:hover { color: #4f46e5; }

    /* ================= PAGE ================= */
    .customers-page {
      font-family: 'Poppins', sans-serif;
      background: #f5f7fb;
      min-height: calc(100vh - 64px);
      padding: 30px;
    }

    .customers-container {
      max-width: 1100px;
      margin: auto;
      background: #ffffff;
      padding: 25px;
      border-radius: 14px;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
    }

    .customers-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th {
      background: #f0f1ff;
      padding: 12px;
      font-size: 13px;
      color: #4f46e5;
      text-align: left;
    }

    td {
      padding: 12px;
      font-size: 13px;
      border-bottom: 1px solid #eee;
      color: #444;
    }

    tr:hover { background: #fafafa; }

    .hearts {
      color: #e11d48;
      font-size: 15px;
      letter-spacing: 1px;
    }

    .eligible {
      background: #dcfce7;
      color: #166534;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }

    .not-eligible {
      background: #fee2e2;
      color: #991b1b;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: 500;
    }
  </style>
</head>

<body>

<!-- ================= NAVBAR ================= -->
<div class="navbar">
  <div class="nav-left">
    <div class="brand-icon">üß∂</div>
    <div class="brand-name">Crochet Admin</div>
  </div>

  <div class="nav-links">
    <a href="index.html">Add Order</a>
    <a href="orders.html">View Orders</a>
    <a href="customers.html">Customers</a>
    <a href="dashboard.html">Dashboard</a>
  </div>
</div>

<!-- ================= CUSTOMERS PAGE ================= -->
<div class="customers-page">
  <div class="customers-container">

    <div class="customers-header">
      <h2>Customers</h2>
      <input
        type="text"
        id="searchInput"
        placeholder="Search name or contact..."
        style="padding:8px 12px;border-radius:8px;border:1px solid #ddd;"
        oninput="filterCustomers()"
      />
    </div>

    <table id="customersTable">
      <thead>
        <tr>
          <th>Customer Name</th>
          <th>Contact</th>
          <th>Total Orders</th>
          <th>Hearts</th>
          <th>Total Purchase (‚Çπ)</th>
          <th>Free Gift</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

  </div>
</div>

<script>
const API_KEY = "AIzaSyBOYSx1ViWXNl8OJG0s1aQDjGJm6A8r9dE";
const SPREADSHEET_ID = "10Z1De-hhJkihZsncW15xlz-VihhGodcWP1eGWWJ7bNU";
const CUSTOMERS_RANGE = "Customers!A2:F";

let ALL_CUSTOMERS = [];

async function fetchCustomers() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${SPREADSHEET_ID}/values/${CUSTOMERS_RANGE}?key=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();

  ALL_CUSTOMERS = data.values || [];
  renderCustomers(ALL_CUSTOMERS);
}

function renderCustomers(customers) {
  const tbody = document.querySelector("#customersTable tbody");
  tbody.innerHTML = "";

  customers.forEach(row => {
    const [
      customerId,
      name,
      contact,
      totalOrders,
      hearts,
      totalPurchase
    ] = row;

    const giftEligible = Number(hearts) >= 5;

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${name}</td>
      <td>${contact}</td>
      <td>${totalOrders}</td>
      <td class="hearts">${"‚ù§Ô∏è".repeat(Number(hearts) || 0)}</td>
      <td>‚Çπ${totalPurchase}</td>
      <td>
        <span class="${giftEligible ? "eligible" : "not-eligible"}">
          ${giftEligible ? "Eligible" : "Not Eligible"}
        </span>
      </td>
    `;

    tbody.appendChild(tr);
  });
}

function filterCustomers() {
  const q = document.getElementById("searchInput").value.toLowerCase();
  const filtered = ALL_CUSTOMERS.filter(row =>
    row[1].toLowerCase().includes(q) || row[2].toLowerCase().includes(q)
  );
  renderCustomers(filtered);
}

window.addEventListener("DOMContentLoaded", fetchCustomers);
</script>

</body>
</html>
